{
  "hash": "e75a6c5bf6b7c883171918f314af4cb7",
  "result": {
    "markdown": "---\ntitle: \"Example analysis\"\nformat: \n  html:\n    fig-width: 8\n    fig-height: 6\n---\n\n\n**Example analysis on tuition cost for college student in the United States**\n\n![Colleges in the US](images/college-and-university-rankings.jpg){fig-alt=\"source: collegestats.org\"}\n\n## Introduction\n\nIn this part, I will perform an example data analysis with R. \n\nObjective: \n\n-   What is the trend of tuition cost among public, private and all institutions in the United States? \n-   What is the most expensive university in Maryland?\n\nIntended audience:\n\n-   People who study public policy for education\n-   High school and college students\n-   Parents and teachers are also potential audiences.\n\nLink to original data:The two datasets for this part of the assignment comes from [TidyTuesday](https://www.tidytuesday.com).\n\n::: callout-note\nThis example analysis will only use two out of five datasets from the original tidytuesday data. More information about the diversity, salary, income related to US collges can be found in other datasets.\n:::\n\n## Data\n\nSpecifically, we will use the following data from March 2020.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages\n───────────────────────────────────────\ntidyverse 1.3.2 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.7     ✔ stringr 1.4.0\n✔ tidyr   1.2.0     ✔ forcats 0.5.2\n✔ readr   2.1.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(lubridate)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'lubridate'\n\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nhere() starts at /Users/longtingxi/R/statcomputing/TLong\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntuesdata <- tidytuesdayR::tt_load('2020-03-10')\ntuesdata <- tidytuesdayR::tt_load(2020, week = 11)\ntuition_cost <- tuesdata$tuition_cost\nhist_tuition <- tuesdata$historical_tuition\n```\n:::\n\n\n::: {.callout-tip appearance=\"simple\"}\nTo avoid re-downloading data, we will check to see if those files already exist using an `if()` statement:\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!dir.exists(here(\"data\"))) { dir.create(here(\"data\")) }\n\nif(!file.exists(here(\"data\",\"tuesdata_cost.RDS\"))){\n  tuesdata <- tidytuesdayR::tt_load('2020-03-10')\n  tuition_cost <- tuesdata$tuition_cost\n  hist_tuition <- tuesdata$historical_tuition\n  \n  # save the files to RDS objects\n  saveRDS(tuesdata$tuition_cost, file = here(\"data\",\"tuesdata_cost.RDS\"))\n  saveRDS(tuesdata$hist_tuition, file = here(\"data\",\"tuesdata_hist.RDS\"))\n}\n```\n:::\n\n\nLet's load the datasets\n\n::: {.cell}\n\n```{.r .cell-code}\nhist_tuition <- readRDS(here(\"data\",\"tuesdata_hist.RDS\"))\ntuition_cost <- readRDS(here(\"data\",\"tuesdata_cost.RDS\"))\n```\n:::\n\n\n\n\n-   Here is a list of full [data dictionary](https://github.com/rfordatascience/tidytuesday/tree/master/data/2020/2020-03-10/readme.md#data-dictionary) for what all the column names mean. The data dictionary for this example analysis is also shown below.\n\n### **historical_tuition.csv**\n\n| variable     | class     | description                                                                                                                                     |\n|:--------------------------|:--------------------|:------------------------|\n| type         | character | Type of school (All, Public, Private)                                                                                                           |\n| year         | character | Academic year                                                                                                                                   |\n| tuition_type | character | Tuition Type All Constant (dollar inflation adjusted), 4 year degree constant, 2 year constant, Current to year, 4 year current, 2 year current |\n| tuition_cost | double    | Tuition cost in USD                                                                                                                             |\n\n### **tuition_cost.csv**\n\n| variable             | class     | description                                                                           |\n|:---------------------------------|:-----------------|:-------------------|\n| name                 | character | School name                                                                           |\n| state                | character | State name                                                                            |\n| state_code           | character | State Abbreviation                                                                    |\n| type                 | character | Type: Public, private, for-profit                                                     |\n| degree_length        | character | 4 year or 2 year degree                                                               |\n| room_and_board       | double    | Room and board in USD                                                                 |\n| in_state_tuition     | double    | Tuition for in-state residents in USD                                                 |\n| in_state_total       | double    | Total cost for in-state residents in USD (sum of room & board + in state tuition)     |\n| out_of_state_tuition | double    | Tuition for out-of-state residents in USD                                             |\n| out_of_state_total   | double    | Total cost for in-state residents in USD (sum of room & board + out of state tuition) |\n\n## Tasks\n\n### What is the trend of tuition cost for colleges in the US?\n\nUsing the `hist_tution` data, find the 4-year constant tuition cost for private, public and all institutions from 1985-2016.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1.  Add a column that just keeps the first `year`.\nhist_tuition$in_year <- as.Date(as.character(substr(hist_tuition$year, 1, 4)), format = \"%Y\")\n# 2.  Plot the trend \nggplot(data=hist_tuition, aes(x=in_year, y = tuition_cost)) + \n  geom_point(aes(colour = type))+facet_wrap(.~tuition_type,nrow = 3)+\n  labs(title =\"Changes in tuition cost for different types of universities from 1985\", \n       subtitle = \"An increasing trend is observed among public and private instituions\", caption = \"Tingxi Long\")+\n  theme_classic()+theme(strip.background =element_rect(fill=\"azure2\"))+\n  scale_x_date(date_breaks = \"5 years\", date_minor_breaks = \"2 years\")+\n  theme(axis.text.x = element_text(angle = -30, vjust = 0.5, hjust=0))+ylab(\"Cost of tuition (US dollor)\")+xlab(\"Year\")\n```\n\n::: {.cell-output-display}\n![](data_analysis_files/figure-html/unnamed-chunk-5-1.png){width=768}\n:::\n:::\n\n\n### Which State has the highest average tuition cost?\n\nIn this part, I will use `tuition_cost` to explore the tuition by university and by state in the US.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Only include 4-year programs.\ntype_4c <- tuition_cost %>% \n  filter(degree_length == \"4 Year\") %>%\n  group_by(state_code,type) %>%\n  summarise(\n    ave_outstate=mean(out_of_state_tuition), .groups = 'drop'\n  )%>%\n  arrange(desc(ave_outstate))\n```\n:::\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nggplot(head(type_4c,20), aes(fill=type,x= ave_outstate, y =fct_reorder(.f=state_code, .x = ave_outstate) ))+geom_bar(stat='identity')+\n  theme(axis.title.y = element_text(vjust =+3))+xlab(\"Cost in dollar\")+ylab(\"Cost in dollar\")+scale_fill_brewer(palette=\"Pastel2\")+theme(axis.text.x = element_text(angle = -30, vjust = 0.5, hjust=0))+ labs(title =\"Average out of state tuition cost by state\",\n           subtitle =\"The most expensive State is Rhode Island, Connecticut and Massachusetts, \n19 out of 20 in the most expensive average out of state tuitions are from private institutions\", \n                                 caption = \"Tingxi Long\") +theme_bw()\n```\n\n::: {.cell-output-display}\n![](data_analysis_files/figure-html/unnamed-chunk-7-1.png){width=768}\n:::\n:::\n\n\nWhen only 4-year programs were included, the top 3 most expensive State is Rhode Island, Connecticut and Massachusetts, with average out of state cost exceeding 40,000 dollars per year. 19 out of 20 in the most expensive average out of state tuitions are from private institutions.\n\n### The top 10 most expensive universities in Maryland.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter only universities in Maryland\ntuition_md <- tuition_cost %>% \n  filter(state_code == \"MD\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntuition_md %>% \n  filter(degree_length == \"4 Year\") %>%  # Only analyze 4-year programs\n  ggplot(aes(x=out_of_state_tuition, y=fct_reorder(.f=name,.x=out_of_state_tuition),fill=type))+geom_bar(stat='identity')+\n  theme_bw()+ labs(title =\"The tuition of university in Maryland by decreasing order\", subtitle = \"The most expensive university in Maryland \nis Johns Hopkins University\", caption = \"Tingxi Long\")+ ylab(\"University\")+xlab(\"Out of State tuition\")+ geom_vline(xintercept = 42260)\n```\n\n::: {.cell-output-display}\n![](data_analysis_files/figure-html/unnamed-chunk-9-1.png){width=768}\n:::\n:::\n\n\n## Summary:\n\n8 colleges in Maryland has an out of state tuition higher than the average out of state tuition in Rhode Island. \n\n``` {.r filename=\"Functions used in dplyr and tidyr and ggplot\"}\ntidyr::\n  as.Date\ndplyr::\n  filter\n  summarise\n  group_by\n  arrange\nggplot:\n  geom_point\n  geom_bar\n  geom_vline\n```\n\n-   Your analysis must include a `.bib` file, which you use to reference at least three unique citations. For example, it could be to a website or paper from where the original data came from or it could be to a paper describing a method you are using to analyze the data.\n\n",
    "supporting": [
      "data_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}